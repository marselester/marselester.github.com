==========================================
Моделирование одноканальной СМО с отказами
==========================================

:date: 2009-05-30
:tags: php, modeling, single-channel queue
:category: Misc
:slug: modeling-single-channel-queue-with-refusals

Дана одноканальная система массового обслуживания с отказами. В нее поступают
заявки через промежуток времени ``n``, где ``n`` – случайная величина,
подчиненная равномерному закону распределения. Время обслуживания заявки
системой ``m`` также является случайной величиной с показательным законом
распределения. Если к моменту прихода заявки канал занят, заявка покидает
систему необслуженной.

::

    <?php
    // Интенсивность потока обслуживания
    $m = 0.5;
    // Время работы системы
    $time_work = 70;
    // Текущее время системы
    $time_system = 0;
    // Время, когда освободится канал
    $chanel = 0;
    // Количество заявок, которым отказано в обработке
    $cnt_denied = 0;
    // Количество обработанных заявок
    $cnt_processed = 0;

    /**
     * Равномерный закон распределения
     */
    function uniform() {
        return rand(1, 1000) / 1000;
    }
     
    /**
     * Показательный закон распределения
     */
    function exponential() {
        global $m;
        return (-1 / $m) * log(rand(1, 1000) / 1000);
    }
     
    while ($time_system <= $time_work) {
        // Время, через сколько поступила новая заявка
        $time_claim_in = uniform();

        $time_system += $time_claim_in;

        echo "Время, через сколько поступила новая заявка: $time_claim_in<br/>";
        echo "Текущее время системы: $time_system<br/>";

        // Проверка, свободен ли канал
        if ($chanel <= $time_system) {
            $cnt_processed++;

            // Время, на которое заявка заняла канал
            $time_claim_busy = exponential();
            $chanel = $time_system + $time_claim_busy;
     
            echo "Заявка заняла канал на: $time_claim_busy<br/>";
            echo "Время, когда освободится канал: $chanel<br/>";
        }
        // Отказываем заявке в обслуживании
        else {
            echo 'Заявке отказано<br/>';
            $cnt_denied++;
        }
     
        echo '<hr/>';
    }
     
    $cnt_total = $cnt_processed + $cnt_denied;
    $P_deny = $cnt_denied / $cnt_total;
    $Q = $cnt_processed / $cnt_total;
    $A = $cnt_processed / $time_work;
     
    echo "<b>Общее число заявок:</b> $cnt_total<br/>";
    echo "<b>Количество обработанных заявок:</b> $cnt_processed<br/>";
    echo "<b>Количество заявок, которым отказано в обработке:</b> $cnt_denied<br/>";
    echo "<b>Вероятность отказа:</b> $P_deny<br/>";
    echo "<b>Доля обслуженных заявок:</b> $Q<br/>";
    echo "<b>Абсолютная пропускная способность:</b> $A<br/>";
    ?>
