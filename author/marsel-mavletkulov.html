<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>marselester's blog - Marsel Mavletkulov</title>

    <link rel="stylesheet" href="http://marselester.com/theme/css/normalize.css" />
    <link rel="stylesheet" href="http://marselester.com/theme/css/foundation.min.css" />
    <link rel="stylesheet" href="http://marselester.com/theme/css/style.css" />
    <link rel="stylesheet" href="http://marselester.com/theme/css/pygments.css" />	
    <script src="http://marselester.com/theme/js/custom.modernizr.js"></script>

    <!-- So Firefox can bookmark->"abo this site" -->
        <link href="feeds/all.atom.xml" rel="alternate" title="marselester's blog" type="application/atom+xml">

</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href="http://marselester.com">marselester's blog</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">
    <li><a href="http://marselester.com/cv/" class="button secondary small">CV</a></li>

            <li><a href="http://marselester.com/pages/about.html" class="button secondary small">About</a></li>
    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
        
        

            <article>
                <a href="http://marselester.com/how-to-structure-go-projects.html"><h3 class="article-title">How to Structure Go Projects</h3></a>
<h6 class="subheader" title="2018-09-28T00:00:00+07:00">Fri 28 September 2018
</h6>


<p>I came to Go from Django where the framework defines project layout, thus I wanted to know
how to structure my Go applications. After reading documentation and building a few Django projects,
you get a clear mental picture, as most of the questions are already answered.
That helps to keep the projects within a company consistent, so developers don't have to struggle
when they land on a new codebase. I was looking for a similar framework approach in Go,
but none of them felt right to me. For some reason the same concepts do not resonate with Go.
I didn't have better ideas, so I watched a few videos from conferences.
Here are the talks I found most helpful and I use them as guidelines:</p>
<ul class="simple">
<li>Ben Johnson's <a class="reference external" href="https://www.youtube.com/watch?v=LMSbsW1Xpwg">Structuring Applications for Growth</a></li>
<li>Kat Zien's <a class="reference external" href="https://www.youtube.com/watch?v=oL6JBUk6tj0">How Do You Structure Your Go Apps</a></li>
<li>Peter Bourgon's <a class="reference external" href="https://www.youtube.com/watch?v=LHe1Cb_Ud_M">Ways To Do Things</a>.
I tried his ideas in <a class="reference external" href="https://github.com/marselester/rascaldb/blob/master/rascaldb.go">RascalDB 😜</a>
to serialize concurrent DB actions.</li>
</ul>
<p>I encourage you to watch those talks and go over code examples they provided.</p>
<p>The following is my takeaway which could be completely misleading and far from the original ideas
(just in case, you don't have to apply all of them together).
If you feel something doesn't bring enough value in your case, just skip it, trust your intuition.
Development requires many iterations to bounce ideas until the result becomes good enough.</p>
<div class="section" id="know-your-domain">
<h2>Know Your Domain</h2>
<p>I like to start a new project on A4 paper and dump everything I know in free form
(what the problem are you facing, can you solve it without writing code,
what are possible solutions (pros/cons), terminology, system requirements, API endpoints, sketches,
doodles, whatever gets your train of thoughts moving). Paper helps to get away from constraints of computer,
I can write and draw without any programs which would otherwise have taken time and stolen my brain cycles.
Paper helps me to stay focused — nothing blinks, pops up or rings, there is no urge to multitask
(check email/Slack, switch between editor and console as if there is something new).</p>
<p>Once you wrote everything down, you might realize there is not enough information to make progress.
So you can reach out to stake holders and get more insights using your notes.
Don't forget to write new info as well. It might take a few iterations when you finally establish
common terminology, refine the actual project's goal, and cut unnecessary features/requirements.</p>
<p>Now you have a mental picture of the project with clear deliverables.
Based on that I like to spend time to come up with a concise project/repository name which
summarizes nicely the project's goal and spirit (thesaurus comes to the rescue).
As a next step I usually create README file where insights from the paper are documented.
This time you want everyone in the world to understand what you learned about the project.
This helps you to iterate once more as you're documenting in README, and the end result
can be shared with coworkers (they might not understand your handwriting and doodles).
If they have questions, that means you have a room for improvement, since other people
don't have a context you obtained. Take your time and write it down, this will ensure that
you will be able to get help with the project much easier (when you're on vacation or
have to hand over the code). With some practice you'll anticipate questions and
provide answers in README, so it won't take as much time from your coworkers next time.
Keeping in mind that you are ultimately solving problems for your customers and
designing the system and writing code for your coworkers (not just for yourself)
helps to rigorously document as you go. Or else prepare to answer the same questions
over and over again. In order to get better at documenting, I recommend reading
<a class="reference external" href="http://www.writethedocs.org/guide/writing/beginners-guide-to-docs/">A beginner’s guide to writing documentation</a>
and <a class="reference external" href="http://www.writethedocs.org/guide/">Documentation Guide</a>.</p>
<p>Let's say you're building an API client, then it makes sense to start from
a usage example in the README, since most of the documentation work is done by API provider.
How will people download your library? How will they import it, does the path look concise and clear?
How will your end user configure a client? What use cases your users might have (custom API domain,
timeouts, logging, instrumentation)? Think of a few workflows and see how would you handle errors.
Best case scenario is using your own library to reveal pain points.
Check out <a class="reference external" href="https://github.com/marselester/bitgo-v2">one of my attempts</a> to find a decent layout of
an API library. The library has a configurable client (you can instantiate many of them, e.g., one per coin)
which allows to use a custom logger, http.Client, etc. It also has embedded services — things that know
how to speak with particular API endpoints to operate API resources.</p>
</div>
<div class="section" id="getting-to-the-point">
<h2>Getting to the Point</h2>
<p>As you can see from the talks the main theme in Go application structure is heavily
influenced by Domain-Driven Design (DDD). Using the research done on your project,
you shall write down entities (as Go structs) of the domain model and services (as Go interfaces)
which perform operations over those entities.</p>
<p>I should mention that for simplicity's sake in my projects I decided to combine DDD &quot;service&quot; and
&quot;repository&quot; concepts under &quot;service&quot; term.</p>
<p>Let's proceed with listing minimal set of operations over the key entities to keep the scope small.
It helps to imagine that there are different service implementations,
an entity can be stored anywhere, for example, in Postgres, Kafka, memory, Redis,
JSON file, remote API. But keep in mind semantics that storage of choice provides:
getting a list of entities from Kafka and Postgres are hard to abstract (streaming vs quering).
Moreover, if you do so, you might create unnecessary constraints for yourself.
In reality, it is very unlikely that a project will change storages often,
since you've chosen them for a reason (the choice of the storage is influenced
by a problem you're solving, its constraints and guarantees you need).
Most likely you've already chosen the storages in advance, so make sure you
don't fight with interfaces you defined in your domain model. If you know your services
need to share the same SQL transaction, embrace it in interfaces, for instance:</p>
<div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">PaymentService</span> <span class="kd">interface</span> <span class="p">{</span>
  <span class="nx">CreatePayment</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">tx</span> <span class="o">*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">Tx</span><span class="p">,</span> <span class="o">*</span><span class="nx">Payment</span><span class="p">)</span> <span class="kt">error</span>
<span class="p">}</span>
</pre></div>
<p>Do you put all operations (add/list) into one service interface? I don't know.
You have to decide. If you add an entity to Postgres, you expect to list them
from Postgres as well. From this perspective &quot;add&quot; and &quot;list&quot; operations should be
under the same interface. If in-memory storage can't implement the service interface,
perhaps you don't have to enforce operation under the same interface,
then probably it's ok to split it.</p>
<p>Ben Johnson defines entities in a single package where domain model is described — the package
shouldn’t have third party dependencies. Whereas Kat Zien in her demo created a package per service:
&quot;adder&quot; package that adds beers and reviews, &quot;lister&quot; service lists beers and reviews.
Each package defines its own beer and review structs.</p>
<p>In my projects I isolate services implementation in a single package.
For example, if I stored beer reviews in Kafka, I would have a kafka package which exposes
a client and beer/review services embedded in it. The same applies to postgres package — two services use
the same db connection pool and beer/review entities might appear in the same db transaction.</p>
<p>During coding I combine the service implementations into a program (some server or
a ctl tool) kept in cmd directory. That helps me to validate design ideas and notice any awkward
component integrations. Similar to service implementations, try to think where the input and
output could be coming from/to: standard input/output, http, rpc, db.</p>
</div>
<div class="section" id="an-example">
<h2>An Example</h2>
<p>Now let's have a look at <a class="reference external" href="https://github.com/marselester/distributed-payment">distributed payment</a>
demo project where I explored an idea of payment transaction
without atomic commit across 3 Kafka partitions.</p>
<p>The domain model is defined in the repository root (note, you can place your packages
in &quot;internal&quot; directory, so you don't mix them up with unrelated files):</p>
<ul class="simple">
<li><cite>wallet.go</cite> has <cite>Transfer</cite>, <cite>Payment</cite> entities, and services <cite>TransferService</cite>, <cite>PaymentService</cite>
which can create and list the entities. Since the project is based on Kafka,
the interfaces reflect that (<cite>partition</cite>, <cite>offset</cite> params). The services accept <cite>context.Context</cite>
as a first argument, because we should be able to tell implementations to cancel operation.
<a class="reference external" href="https://github.com/opentracing/opentracing-go">OpenTracing</a> can leverage context as well.
Pay attention to a pointer/value semantics (share or not) in the service interfaces.
Since an entity in DDD terms has a unique identity, a pointer semantics was used,
hence <cite>*Transfer</cite> is passed to <cite>CreateTransfer()</cite> and returned from <cite>FromOffset()</cite>. Have a look at
<a class="reference external" href="https://www.ardanlabs.com/blog/2017/06/design-philosophy-on-data-and-semantics.html">Design Philosophy On Data And Semantics</a>
for more insights.</li>
<li><cite>error.go</cite> contains errors which are relevant to the whole domain model,
<a class="reference external" href="https://middlemost.com/failure-is-your-domain/">Failure is your Domain</a>.
On implementation level there could be their own specific errors, for example, HTTP API errors in
<cite>rest/error.go</cite> define JSON and validation errors.</li>
<li><cite>log.go</cite> borrows <cite>Logger</cite> interface from Go kit. Since logging is an integral part of the system,
placing it nearby the domain model seems justified. There is
<a class="reference external" href="https://github.com/go-commons/commons/issues/1">Standard logger interface</a> discussion
where the consensus is to emit events instead of logging in the library.
Best practices and examples of how to emit events is still an
<a class="reference external" href="https://github.com/go-commons/event/issues/1">open topic</a> at the time of writing.</li>
</ul>
<p>Implementations of the services defined in <cite>wallet.go</cite> are isolated in packages
by their dependency name, for example, kafka, rest, mock, rocksdb.</p>
<p>Package kafka implements wallet services and provides the Client access to them.
There were two design options: embed the services to the Client struct or
inject a service into each other. The example below would allow to have
a swappable <cite>PaymentService</cite> (&quot;pg&quot; refers to a Postgres implementation):</p>
<div class="highlight"><pre><span></span><span class="nx">kafka</span><span class="p">.</span><span class="nx">TransferService</span><span class="p">.</span><span class="nx">PaymentService</span> <span class="p">=</span> <span class="nx">pg</span><span class="p">.</span><span class="nx">NewPaymentService</span><span class="p">()</span>
</pre></div>
<p>On the other hand, grouping services in the Client would let services maintain DB transactions
by sharing the same <cite>*sql.DB</cite>. Here is <cite>pg.Client</cite> example:</p>
<div class="highlight"><pre><span></span><span class="c1">// Client represents a client to the underlying PostgreSQL data store.</span>
<span class="kd">type</span> <span class="nx">Client</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">Transfer</span> <span class="o">*</span><span class="nx">TransferService</span>
  <span class="nx">Payment</span>  <span class="o">*</span><span class="nx">PaymentService</span>

  <span class="nx">logger</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">Logger</span>

  <span class="nx">db</span>        <span class="o">*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">DB</span>
  <span class="nx">transferQ</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span>
  <span class="nx">paymentQ</span>  <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span>
<span class="p">}</span>
</pre></div>
<p>In <a class="reference external" href="https://github.com/marselester/distributed-signup/blob/master/pg/user_service.go">distributed-signup</a>
project a Client concept is baked into <cite>UserService</cite>, because it was the only service that
needed access to Postgres.</p>
<div class="highlight"><pre><span></span><span class="c1">// UserService reprensets a service to store signed up users.</span>
<span class="kd">type</span> <span class="nx">UserService</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">config</span> <span class="nx">Config</span>

  <span class="nx">pool</span> <span class="o">*</span><span class="nx">pgx</span><span class="p">.</span><span class="nx">ConnPool</span>
<span class="p">}</span>
</pre></div>
<p>Package rest is responsible for translating incoming HTTP requests to wallet domain and
then translating results from wallet model back to HTTP responses.
The package doesn't implement <cite>TransferService</cite> per se, it uses one in its Server.
The REST-style API server itself is put together in
<a class="reference external" href="https://github.com/marselester/distributed-payment/blob/master/cmd/transfer-server/main.go">cmd/transfer-server</a>.</p>
<div class="highlight"><pre><span></span><span class="c1">// Server represents an HTTP API handler for wallet services.</span>
<span class="c1">// It wraps a TransferService so we can provide different</span>
<span class="c1">// implementations, e.g., Kafka or a mock.</span>
<span class="kd">type</span> <span class="nx">Server</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="o">*</span><span class="nx">chi</span><span class="p">.</span><span class="nx">Mux</span>
  <span class="nx">logger</span>          <span class="nx">wallet</span><span class="p">.</span><span class="nx">Logger</span>
  <span class="nx">transferService</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">TransferService</span>
  <span class="nx">wopts</span>           <span class="nx">walletOption</span>
<span class="p">}</span>
</pre></div>
<p>Originally in <a class="reference external" href="https://medium.com/wtf-dial/wtf-dial-http-api-d8800ccd605f">WTF Dial: HTTP API</a>
Ben Johnson explained how to implement API properly and isolate http dependencies in wtf/http package.</p>
<p>Package mock provides mock services to facilitate testing. For example, for most cases
we do not need Kafka implementation of a transfer service to be used in HTTP API testing.</p>
<p>Package rocksdb implements user requests deduplication using RocksDB to
memorise already processed request IDs. Requests deduplication is an integral part of
a distributed system, hence the domain model must embrace it.</p>
<p>Everything is connected in cmd directory. Note, that the domain package is used everywhere.</p>
<ul class="simple">
<li><cite>cmd/transfer-server</cite> is HTTP API server to create money transfers which are stored in Kafka.
It delegates the actual hard work to kafka and rest packages.</li>
<li><cite>cmd/paymentd</cite> program is responsible for creating incoming &amp; outgoing payment pairs based on
money transfer requests stored in Kafka.</li>
<li><cite>cmd/accountantd</cite> is the last program in the pipeline. It sequentially reads Kafka messages
from <cite>wallet.payment</cite> topic, deduplicates messages by request ID, and applies the changes to
the account balances. Deduplication is provided by rocksdb package mentioned above.</li>
</ul>
<p>To wrap up, that's all I managed to recall :) I look forward for more talks on structuring Go applications.</p>
</div>
<p class="subheader">Category: <a href="http://marselester.com/category/go.html">Go</a>

    Tagged: 
    <a href="http://marselester.com/tag/golang.html">golang </a>
    <a href="http://marselester.com/tag/project-structure.html">project structure </a>
    <a href="http://marselester.com/tag/domain-driven-design.html">Domain-Driven Design </a>
</p>



<p><a href="http://marselester.com/how-to-structure-go-projects.html#disqus_thread">comments</a></p>            </article>


                <hr  class="gradient"/>


        


            <article>
                <a href="http://marselester.com/prometheus-via-dogstatsd.html"><h3 class="article-title">Forward DogStatsD Metrics to Prometheus</h3></a>
<h6 class="subheader" title="2017-06-17T00:00:00+07:00">Sat 17 June 2017
</h6>


<p><strong>tl;dr:</strong> StatsD doesn't have metric labels, DogStatsD does.</p>
<p>This is a follow up post after
<a class="reference external" href="http://marselester.com/django-prometheus-via-statsd.html">Instrumenting Django with Prometheus and StatsD</a>.</p>
<hr class="docutils" />
<p>You got Prometheus up and running and eager to start instrumenting your Django application.
Don't be hasty and read <a class="reference external" href="https://prometheus.io/docs/practices/instrumentation/">Prometheus Best Practices</a>.</p>
<p>Let's say our application has to …</p><p class="subheader">Category: <a href="http://marselester.com/category/infrastructure.html">Infrastructure</a>

    Tagged: 
    <a href="http://marselester.com/tag/prometheus.html">prometheus </a>
    <a href="http://marselester.com/tag/monitoring.html">monitoring </a>
    <a href="http://marselester.com/tag/statsd.html">statsd </a>
    <a href="http://marselester.com/tag/dogstatsd.html">dogstatsd </a>
    <a href="http://marselester.com/tag/datadog.html">datadog </a>
</p>



<p><a href="http://marselester.com/prometheus-via-dogstatsd.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/prometheus-via-dogstatsd.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/django-prometheus-via-statsd.html"><h3 class="article-title">Instrumenting Django with Prometheus and StatsD</h3></a>
<h6 class="subheader" title="2017-06-09T00:00:00+07:00">Fri 09 June 2017
</h6>


<p>If you ever wondered how to monitor your Django application with Prometheus this article is for you.
Quick search on the topic will lead you to <a class="reference external" href="https://github.com/korfuri/django-prometheus/">django-prometheus</a>.
For those who don't want to use it, there is another way to export application metrics
via <a class="reference external" href="https://www.datadoghq.com/blog/statsd/">StatsD</a>.</p>
<p>The idea is to send …</p><p class="subheader">Category: <a href="http://marselester.com/category/infrastructure.html">Infrastructure</a>

    Tagged: 
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/prometheus.html">prometheus </a>
    <a href="http://marselester.com/tag/kubernetes.html">kubernetes </a>
    <a href="http://marselester.com/tag/monitoring.html">monitoring </a>
    <a href="http://marselester.com/tag/statsd.html">statsd </a>
    <a href="http://marselester.com/tag/helm.html">helm </a>
</p>



<p><a href="http://marselester.com/django-prometheus-via-statsd.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/django-prometheus-via-statsd.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/minukube-aws-ecr.html"><h3 class="article-title">Minukube &amp; Amazon EC2 Container Registry</h3></a>
<h6 class="subheader" title="2016-12-05T00:00:00+07:00">Mon 05 December 2016
</h6>


<p><a class="reference external" href="http://kubernetes.io/docs/getting-started-guides/minikube/">Minukube</a> is an easy way to run Kubernetes locally.
When we want to build a Docker image in Minukube (so Kubernetes has an access to it),
we can configure our Docker client to communicate with the Minikube Docker daemon.</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> minikube start
<span class="go">Starting local Kubernetes cluster...</span>
<span class="go">Kubectl is now configured to …</span></pre></div><p class="subheader">Category: <a href="http://marselester.com/category/infrastructure.html">Infrastructure</a>

    Tagged: 
    <a href="http://marselester.com/tag/kubernetes.html">kubernetes </a>
    <a href="http://marselester.com/tag/aws.html">aws </a>
    <a href="http://marselester.com/tag/minukube.html">minukube </a>
</p>



<p><a href="http://marselester.com/minukube-aws-ecr.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/minukube-aws-ecr.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/prometheus-on-kubernetes.html"><h3 class="article-title">Prometheus on Kubernetes</h3></a>
<h6 class="subheader" title="2016-11-13T00:00:00+07:00">Sun 13 November 2016
</h6>


<p><a class="reference external" href="https://prometheus.io/">Prometheus</a> is a monitoring toolkit.
Let's set it up on Kubernetes and test how it works by scraping HTTP request metrics
from <a class="reference external" href="https://github.com/marselester/prometheus-on-kubernetes">hello web application</a>
which also runs in the same cluster.</p>
<p>First of all, we need Kubernetes cluster running. It's easy to bootstrap one via <a class="reference external" href="https://console.cloud.google.com">Google Container Engine</a>.</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> gcloud …</pre></div><p class="subheader">Category: <a href="http://marselester.com/category/infrastructure.html">Infrastructure</a>

    Tagged: 
    <a href="http://marselester.com/tag/prometheus.html">prometheus </a>
    <a href="http://marselester.com/tag/kubernetes.html">kubernetes </a>
    <a href="http://marselester.com/tag/monitoring.html">monitoring </a>
    <a href="http://marselester.com/tag/golang.html">golang </a>
    <a href="http://marselester.com/tag/google-container-engine.html">Google Container Engine </a>
</p>



<p><a href="http://marselester.com/prometheus-on-kubernetes.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/prometheus-on-kubernetes.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/drf-pagination.html"><h3 class="article-title">Django REST framework: pagination on PostgreSQL triggers</h3></a>
<h6 class="subheader" title="2016-04-02T00:00:00+07:00">Sat 02 April 2016
</h6>


<p>Django and Django REST Framework use SQL COUNT in pagination.
As your database grows SQL COUNT becomes too slow. Fortunately the frameworks
are well designed and allow to customize a way items are count.
Let me illustrate that on a typical &quot;books&quot; example.</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField …</span></pre></div><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/postgresql.html">postgresql </a>
    <a href="http://marselester.com/tag/django-rest-framework.html">django rest framework </a>
    <a href="http://marselester.com/tag/pagination.html">pagination </a>
</p>



<p><a href="http://marselester.com/drf-pagination.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/drf-pagination.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/api-based-on-flask.html"><h3 class="article-title">API based on Flask</h3></a>
<h6 class="subheader" title="2013-12-09T00:00:00+07:00">Mon 09 December 2013
</h6>


<p>Here I want to consider implementation of API best practices which
usually don't follow Fielding's REST strictly. <a class="reference external" href="https://github.com/marselester/api-example-based-on-flask">Example Flask project</a>
is on GitHub.</p>
<div class="section" id="api-versioning">
<h2>API Versioning</h2>
<p>Interfaces are changed hence versioning is mandatory in order to not annoy
your users. You might need to add new resource or field to particular …</p></div><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/flask.html">flask </a>
    <a href="http://marselester.com/tag/api.html">api </a>
</p>



<p><a href="http://marselester.com/api-based-on-flask.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/api-based-on-flask.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/saltstack-slides.html"><h3 class="article-title">Slides about SaltStack</h3></a>
<h6 class="subheader" title="2013-12-03T00:00:00+07:00">Tue 03 December 2013
</h6>


<p><strong>Update</strong> I gave a talk with <a class="reference external" href="https://twitter.com/shr">Simon Robson</a> at <a class="reference external" href="https://twitter.com/barcampcm">Beercamp</a> in Chiang Mai,
Thailand on 12 Dec 2013. We compared Salt and <a class="reference external" href="http://slid.es/simonrobson/ansible">Ansible</a>.
Here are my slides.</p>
<iframe src="http://slid.es/marselester/saltstack/embed" width="576" height="420" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe><p class="subheader">Category: <a href="http://marselester.com/category/infrastructure.html">Infrastructure</a>

    Tagged: 
    <a href="http://marselester.com/tag/salt.html">salt </a>
    <a href="http://marselester.com/tag/saltstack.html">saltstack </a>
    <a href="http://marselester.com/tag/slides.html">slides </a>
    <a href="http://marselester.com/tag/talk.html">talk </a>
</p>



<p><a href="http://marselester.com/saltstack-slides.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/saltstack-slides.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/developing-and-deploying-django-project-with-saltstack.html"><h3 class="article-title">Developing &amp; Deploying Django project with SaltStack</h3></a>
<h6 class="subheader" title="2013-11-28T00:00:00+07:00">Thu 28 November 2013
</h6>


<p>Eventually you will need to deploy project,
but deployment was not considered in the <a class="reference external" href="http://marselester.com/developing-django-project-with-saltstack.html">previous post</a>. Let's find it out.</p>
<p>Server configuration is different from local, thus environments will be needed
(at least production <strong>prod</strong> and development <strong>dev</strong>). Salt uses <strong>base</strong>
environment by default.</p>
<p>Environments are set in <tt class="docutils literal">minion.conf …</tt></p><p class="subheader">Category: <a href="http://marselester.com/category/infrastructure.html">Infrastructure</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/vagrant.html">vagrant </a>
    <a href="http://marselester.com/tag/salt.html">salt </a>
    <a href="http://marselester.com/tag/saltstack.html">saltstack </a>
</p>



<p><a href="http://marselester.com/developing-and-deploying-django-project-with-saltstack.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/developing-and-deploying-django-project-with-saltstack.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/developing-django-project-with-saltstack.html"><h3 class="article-title">Developing Django project with SaltStack</h3></a>
<h6 class="subheader" title="2013-11-09T00:00:00+07:00">Sat 09 November 2013
</h6>


<p>Let's use <a class="reference external" href="https://github.com/marselester/abstract-internal-messaging">Messaging System</a> as an example of Django project. I want it to
run in VirtualBox which is managed by Vagrant. Infrastructure management
is provided by SaltStack.</p>
<p>I advise you to create separate folder for repositories (currently there
is only one) of project and clone <a class="reference external" href="https://github.com/marselester/abstract-internal-messaging">Messaging System</a> there.
Also …</p><p class="subheader">Category: <a href="http://marselester.com/category/infrastructure.html">Infrastructure</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/vagrant.html">vagrant </a>
    <a href="http://marselester.com/tag/salt.html">salt </a>
    <a href="http://marselester.com/tag/saltstack.html">saltstack </a>
</p>



<p><a href="http://marselester.com/developing-django-project-with-saltstack.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/developing-django-project-with-saltstack.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/preparation-to-python-interview.html"><h3 class="article-title">Preparation to Python Interview</h3></a>
<h6 class="subheader" title="2012-11-02T00:00:00+07:00">Fri 02 November 2012
</h6>


<p>I decided to collect a little more information and experience during
preparation to Python developer interview. These are some information and
links which seemed important to me. Maybe it will be helpful.</p>
<div class="section" id="how-does-it-usually-go">
<h2>How does it usually go?</h2>
<div class="section" id="what-kind-of-projects-did-you-participate-in">
<h3>What kind of projects did you participate in?</h3>
<p>What did you do at …</p></div></div><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/interview.html">interview </a>
</p>



<p><a href="http://marselester.com/preparation-to-python-interview.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/preparation-to-python-interview.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/django-todo-testing-during-construction.html"><h3 class="article-title">Django TODO: тестирование во время конструирования</h3></a>
<h6 class="subheader" title="2012-06-29T13:00:00+07:00">Fri 29 June 2012
</h6>


<p>Тестирование, выполняемое разработчиками -- один из важнейших элементов полной
стратегии тестирования.</p>
<p>Тестирование может указать только на отдельные дефектные области программы --
оно не сделает программу удобнее в использовании, более быстрой, компактной,
удобочитаемой или расширяемой.</p>
<p>Цель тестирования противоположна целям других этапов разработки. Его целью
является нахождение ошибок. Успешным считается тест, нарушающий работу ПО …</p><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/django-todo.html">django-todo </a>
    <a href="http://marselester.com/tag/testing.html">testing </a>
</p>



<p><a href="http://marselester.com/django-todo-testing-during-construction.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/django-todo-testing-during-construction.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/django-todo-system-construction.html"><h3 class="article-title">Django TODO: конструирование системы</h3></a>
<h6 class="subheader" title="2012-06-29T12:00:00+07:00">Fri 29 June 2012
</h6>


<p>При работе над проектом конструирование включает другие процессы, в том числе
проектирование. Формальная архитектура дает ответы только на вопросы
системного уровня, при этом значительная часть проектирования может быть
намеренно оставлена на этап конструирования. Проектирование -- это
&quot;постепенный&quot; процесс. Проекты приложений не возникают в умах разработчиков
сразу в готовом виде. Они развиваются …</p><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/django-todo.html">django-todo </a>
    <a href="http://marselester.com/tag/construction.html">construction </a>
</p>



<p><a href="http://marselester.com/django-todo-system-construction.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/django-todo-system-construction.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/django-todo-design-architecture.html"><h3 class="article-title">Django TODO: проектирование архитектуры системы</h3></a>
<h6 class="subheader" title="2012-06-29T11:00:00+07:00">Fri 29 June 2012
</h6>


<p>Следующим этапом разработки системы является проектирование архитектуры.</p>
<p>Архитектура должна быть продуманным концептуальным целым. Главный тезис самой
популярной книги по разработке ПО &quot;Мифический человеко-месяц&quot; гласит, что
основной проблемой, характерной для крупных систем, является поддержание их
концептуальной целостности. Хорошая архитектура должна соответствовать
проблеме <a class="footnote-reference" href="#mcconnell" id="id1">[1]</a>.</p>
<p>Разделение системы на подсистемы на уровне архитектуры, позволяет …</p><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/django-todo.html">django-todo </a>
    <a href="http://marselester.com/tag/architecture.html">architecture </a>
</p>



<p><a href="http://marselester.com/django-todo-design-architecture.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/django-todo-design-architecture.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/django-todo-development-of-system-requirements.html"><h3 class="article-title">Django TODO: выработка требований к системе</h3></a>
<h6 class="subheader" title="2012-06-29T11:00:00+07:00">Fri 29 June 2012
</h6>


<p>После прочтения Макконелла захотелось спроецировать его советы на Django.
Для этого я взял за основу разработку системы <a class="reference external" href="https://github.com/marselester/django-todo">Django TODO</a>. Итак, первый этап -- выработка требований к
системе.</p>
<p>Требования подробно описывают, что должна делать система. Внимание к
требованиям помогает свести к минимуму изменения системы после начала
разработки. Явные требования помогают гарантировать, что …</p><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/django-todo.html">django-todo </a>
    <a href="http://marselester.com/tag/requirements.html">requirements </a>
</p>



<p><a href="http://marselester.com/django-todo-development-of-system-requirements.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/django-todo-development-of-system-requirements.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/links-to-best-practices-of-python-django.html"><h3 class="article-title">Соглашения по разработке на Python/Django</h3></a>
<h6 class="subheader" title="2012-06-29T00:00:00+07:00">Fri 29 June 2012
</h6>


<p>Во время разработки я часто сверяюсь с известными мне соглашениями,
стараюсь следовать рекомендациям. Цитировать их не имеет смысла -- лучше
приведу ссылки.</p>
<p><a class="reference external" href="http://www.python.org/dev/peps/pep-0008/">PEP 8 -- Style Guide for Python Code</a>.</p>
<p><a class="reference external" href="http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#long-lines-continuations">Code Like a Pythonista: Idiomatic Python</a>.
В нем я нашел ответы на вопросы форматирования длинных строк:</p>
<pre class="literal-block">
expended_time = (self.finish_date() - self.start_date
                 + datetime …</pre><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/best-practices.html">best practices </a>
</p>



<p><a href="http://marselester.com/links-to-best-practices-of-python-django.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/links-to-best-practices-of-python-django.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/splitting-settings-in-django.html"><h3 class="article-title">Разделение настроек в Django</h3></a>
<h6 class="subheader" title="2012-06-29T00:00:00+07:00">Fri 29 June 2012
</h6>


<p>В <a class="reference external" href="https://code.djangoproject.com/wiki/SplitSettings">Django wiki</a> собраны
различные способы разделения настроек. Мне нравится <a class="reference external" href="http://senko.net/en/django-quickstart-skeleton-project/">вариант</a>, описанный в блоге
Senko Rašić:</p>
<pre class="literal-block">
settings/
├── __init__.py
├── base.py
├── development.py
├── local.py
└── production.py
</pre>
<p><tt class="docutils literal">base.py</tt> содержит общие настройки для <tt class="docutils literal">development.py</tt> и
<tt class="docutils literal">production.py</tt>, например:</p>
<div class="highlight"><pre><span></span><span class="n">ADMINS</span> <span class="o">=</span> <span class="p">()</span>
<span class="n">MANAGERS</span> <span class="o">=</span> <span class="n">ADMINS</span>

<span class="n">TIME_ZONE</span> <span class="o">=</span> <span class="s1">&#39;Asia/Yekaterinburg&#39;</span>
<span class="c1"># ...</span>
</pre></div>
<p><tt class="docutils literal">production.py</tt> содержит настройки для …</p><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/settings.html">settings </a>
</p>



<p><a href="http://marselester.com/splitting-settings-in-django.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/splitting-settings-in-django.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/short-overview-of-infrastructure-for-developing-reusable-django-apps.html"><h3 class="article-title">Краткий обзор инфраструктуры для разработки reusable Django приложений</h3></a>
<h6 class="subheader" title="2012-06-13T00:00:00+07:00">Wed 13 June 2012
</h6>


<p>Начиная впервые разрабатывать веб-приложения на новом фреймворке программист
зачастую сталкивается с некоторыми трудностями. При разработке отчуждаемых
веб-приложений на Django к этим проблемам необходимо отнести организацию
файлов в проекте, обнаружение тестов, вопросы пакетирования приложений и
организации автоматизированного тестирования. В данной статье приведены пути
решения этих проблем.</p>
<p>Важно знать различия между двумя …</p><p class="subheader">Category: <a href="http://marselester.com/category/python.html">Python</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/infrastructure.html">infrastructure </a>
</p>



<p><a href="http://marselester.com/short-overview-of-infrastructure-for-developing-reusable-django-apps.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/short-overview-of-infrastructure-for-developing-reusable-django-apps.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/computing-methods-of-one-dimensional-optimization.html"><h3 class="article-title">Вычислительные методы одномерной оптимизации</h3></a>
<h6 class="subheader" title="2010-10-06T00:00:00+07:00">Wed 06 October 2010
</h6>


<p>На третьем курсе по предмету методы оптимизации делали лабораторную работу на
тему «Вычислительные методы одномерной оптимизации».
Задача заключалась в поиске безусловного минимума функции
<tt class="docutils literal">f(x) = pow(x, 3) – x + pow(e, <span class="pre">-x)</span></tt> на начальном интервале <tt class="docutils literal">[0, 1]</tt>
с точностью <tt class="docutils literal">0.00001</tt>.</p>
<p>Вычисления производились через:</p>
<ul class="simple">
<li>пассивный метод;</li>
<li>равномерные блочные методы;</li>
<li>метод …</li></ul><p class="subheader">Category: <a href="http://marselester.com/category/misc.html">Misc</a>

    Tagged: 
    <a href="http://marselester.com/tag/php.html">php </a>
    <a href="http://marselester.com/tag/mathematical-optimization.html">mathematical optimization </a>
</p>



<p><a href="http://marselester.com/computing-methods-of-one-dimensional-optimization.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/computing-methods-of-one-dimensional-optimization.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/definition-of-pressing-of-a-combination-of-keys-by-means-BIOS-on-the-assembler.html"><h3 class="article-title">Определение нажатия комбинации клавиш средствами BIOS на ассемблере</h3></a>
<h6 class="subheader" title="2009-12-03T00:00:00+07:00">Thu 03 December 2009
</h6>


<p>По учебе понадобилось написать программу на ассемблере, которая должна
распознать нажатие «горячей» комбинации клавиш <tt class="docutils literal">LeftCtrl+RightShift+F3</tt> и
реагировать на него звуковым сигналом. Информации/примеров по этой теме
маловато, по этому решил опубликовать свою программку.</p>
<div class="highlight"><pre><span></span><span class="nf">masm</span>
<span class="nf">.model</span> <span class="nv">small</span>
<span class="nf">.stack</span> <span class="mi">256</span>
<span class="nf">.data</span>
    <span class="nf">Msg_about</span> <span class="nv">db</span> <span class="s">&#39;Распознать нажатие «горячей» комбинации клавиш&#39;</span><span class="p">,</span> <span class="mh">0Ah</span><span class="p">,</span> <span class="mh">0Dh …</span></pre></div><p class="subheader">Category: <a href="http://marselester.com/category/misc.html">Misc</a>

    Tagged: 
    <a href="http://marselester.com/tag/assembler.html">assembler </a>
</p>



<p><a href="http://marselester.com/definition-of-pressing-of-a-combination-of-keys-by-means-BIOS-on-the-assembler.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/definition-of-pressing-of-a-combination-of-keys-by-means-BIOS-on-the-assembler.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://marselester.com/modeling-single-channel-queue-with-refusals.html"><h3 class="article-title">Моделирование одноканальной СМО с отказами</h3></a>
<h6 class="subheader" title="2009-05-30T00:00:00+07:00">Sat 30 May 2009
</h6>


<p>Дана одноканальная система массового обслуживания с отказами. В нее поступают
заявки через промежуток времени <tt class="docutils literal">n</tt>, где <tt class="docutils literal">n</tt> – случайная величина,
подчиненная равномерному закону распределения. Время обслуживания заявки
системой <tt class="docutils literal">m</tt> также является случайной величиной с показательным законом
распределения. Если к моменту прихода заявки канал занят, заявка покидает
систему необслуженной.</p>
<p>Изначально код был …</p><p class="subheader">Category: <a href="http://marselester.com/category/misc.html">Misc</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/modeling.html">modeling </a>
    <a href="http://marselester.com/tag/single-channel-queue.html">single-channel queue </a>
</p>



<p><a href="http://marselester.com/modeling-single-channel-queue-with-refusals.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://marselester.com/modeling-single-channel-queue-with-refusals.html">Read More</a>
                <hr  class="gradient"/>
            </article>

            <!-- /#posts-list -->

    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="http://marselester.com/archives.html">Archives</a>
            <li><a href="http://marselester.com/tags.html">Tags</a>


                <li><a href="http://marselester.com/feeds/all.atom.xml" rel="alternate">Atom feed</a></li>
        </ul>

		
        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="http://marselester.com/category/go.html">Go</a></li>
            <li><a href="http://marselester.com/category/infrastructure.html">Infrastructure</a></li>
            <li><a href="http://marselester.com/category/misc.html">Misc</a></li>
            <li><a href="http://marselester.com/category/python.html">Python</a></li>
   
        </ul>

		
        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="https://github.com/marselester">GitHub</a></li>
            <li><a href="https://medium.com/@marselester/">Medium</a></li>
            <li><a href="http://twitter.com/marselester">Twitter</a></li>
            <li><a href="http://instagram.com/marselester">Instagram</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
                <p>marselester's blog by Marsel Mavletkulov</p>
            </div>
            </div>
    </div>
</footer>