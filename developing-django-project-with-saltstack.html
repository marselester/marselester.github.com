<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>Developing Django project with SaltStack</title>

    <link rel="stylesheet" href="http://marselester.com/theme/css/normalize.css" />
    <link rel="stylesheet" href="http://marselester.com/theme/css/foundation.min.css" />
    <link rel="stylesheet" href="http://marselester.com/theme/css/style.css" />
    <link rel="stylesheet" href="http://marselester.com/theme/css/pygments.css" />	
    <script src="http://marselester.com/theme/js/custom.modernizr.js"></script>
</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href="http://marselester.com">marselester's blog</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">
    <li><a href="http://marselester.com/cv/" class="button secondary small">CV</a></li>

            <li><a href="http://marselester.com/pages/about.html" class="button secondary small">About</a></li>
    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
<article>
    <header>
        <h3 class="article-title"><a href="http://marselester.com/developing-django-project-with-saltstack.html" rel="bookmark"
        title="Permalink to Developing Django project with SaltStack">Developing Django project with SaltStack</a></h3>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="marselester">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    </header>

<h6 class="subheader" title="2013-11-09T00:00:00">Sat 09 November 2013
</h6>


    <p>Let's use <a class="reference external" href="https://github.com/marselester/abstract-internal-messaging">Messaging System</a> as an example of Django project. I want it to
run in VirtualBox which is managed by Vagrant. Infrastructure management
is provided by SaltStack.</p>
<p>I advise you to create separate folder for repositories (currently there
is only one) of project and clone <a class="reference external" href="https://github.com/marselester/abstract-internal-messaging">Messaging System</a> there.
Also I need a folder for Vagrant files and prefer to name it <tt class="docutils literal">vagrant</tt>.</p>
<div class="highlight"><pre><span class="gp">$</span> mkdir messaging
<span class="gp">$</span> <span class="nb">cd </span>messaging
<span class="gp">$</span> git clone https://github.com/marselester/abstract-internal-messaging.git
<span class="gp">$</span> mkdir abstract-internal-messaging/vagrant
</pre></div>
<p>In order to make friends of Vagrant and SaltStack, I need to install
Salty Vagrant:</p>
<div class="highlight"><pre><span class="gp">$</span> vagrant plugin install vagrant-salt
</pre></div>
<p>I want Vagrant to:</p>
<ul class="simple">
<li>share source code folder <tt class="docutils literal"><span class="pre">messaging/abstract-internal-messaging</span></tt>;</li>
<li>share states and pillars of SaltStack
<tt class="docutils literal"><span class="pre">messaging/abstract-internal-messaging/vagrant/salt/roots</span></tt>;</li>
<li>run minion masterless by <tt class="docutils literal"><span class="pre">salt-call</span> state.highstate</tt>;</li>
<li>assign convenient host name, here it is &quot;messaging-part-1&quot;.</li>
</ul>
<p><tt class="docutils literal">vagrant/Vagrantfile</tt> config responses for these requirements:</p>
<div class="highlight"><pre><span class="c1"># -*- mode: ruby -*-</span>

<span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s1">&#39;precise64&#39;</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box_url</span> <span class="o">=</span> <span class="s1">&#39;http://files.vagrantup.com/precise64.box&#39;</span>

  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="ss">:virtualbox</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="o">|</span>
    <span class="n">v</span><span class="o">.</span><span class="n">customize</span> <span class="o">[</span><span class="s1">&#39;modifyvm&#39;</span><span class="p">,</span> <span class="ss">:id</span><span class="p">,</span> <span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="s1">&#39;messaging-part-1&#39;</span><span class="o">]</span>
    <span class="n">v</span><span class="o">.</span><span class="n">customize</span> <span class="o">[</span><span class="s1">&#39;modifyvm&#39;</span><span class="p">,</span> <span class="ss">:id</span><span class="p">,</span> <span class="s1">&#39;--memory&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="o">]</span>
  <span class="k">end</span>

  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="s1">&#39;messaging-part-1&#39;</span>

  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="ss">:private_network</span><span class="p">,</span> <span class="ss">ip</span><span class="p">:</span> <span class="s1">&#39;1.2.3.4&#39;</span>

  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">synced_folder</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/vagrant/abstract-internal-messaging&#39;</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">synced_folder</span> <span class="s1">&#39;salt/roots&#39;</span><span class="p">,</span> <span class="s1">&#39;/srv&#39;</span>

  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span> <span class="ss">:salt</span> <span class="k">do</span> <span class="o">|</span><span class="n">salt</span><span class="o">|</span>
    <span class="n">salt</span><span class="o">.</span><span class="n">minion_config</span> <span class="o">=</span> <span class="s1">&#39;salt/minion.conf&#39;</span>
    <span class="n">salt</span><span class="o">.</span><span class="n">run_highstate</span> <span class="o">=</span> <span class="kp">true</span>
    <span class="n">salt</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<p>As you could notice, I have not had the <tt class="docutils literal">vagrant/salt</tt> folder yet.
Let's create following directory structure (actually you can just
<tt class="docutils literal">git checkout <span class="pre">salted-vagrant</span></tt>):</p>
<div class="highlight"><pre><span class="gp">$</span> tree abstract-internal-messaging/vagrant
<span class="go">abstract-internal-messaging/vagrant</span>
<span class="go">|-- Vagrantfile</span>
<span class="go">`-- salt</span>
<span class="go">    |-- minion.conf</span>
<span class="go">    `-- roots</span>
<span class="go">        |-- pillar</span>
<span class="go">        |   |-- top.sls</span>
<span class="go">        |   |-- postgresql.sls</span>
<span class="go">        |   `-- website.sls</span>
<span class="go">        `-- salt</span>
<span class="go">            |-- top.sls</span>
<span class="go">            |-- user.sls</span>
<span class="go">            |-- source_code.sls</span>
<span class="go">            |-- python.sls</span>
<span class="go">            |-- redis.sls</span>
<span class="go">            |-- postgresql</span>
<span class="go">            |   |-- init.sls</span>
<span class="go">            |   `-- pg_hba.conf</span>
<span class="go">            `-- website</span>
<span class="go">                |-- django.sls</span>
<span class="go">                |-- wsgiserver.sls</span>
<span class="go">                |-- webserver.sls</span>
<span class="go">                |-- local.py.template</span>
<span class="go">                |-- supervisord.conf</span>
<span class="go">                |-- gunicorn.conf.py</span>
<span class="go">                `-- nginx.conf</span>
</pre></div>
<p><tt class="docutils literal">minion.conf</tt> contains only one string:</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">file_client</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">local</span>
</pre></div>
<p>It means &quot;Don't look for master server when running <tt class="docutils literal"><span class="pre">salt-call</span></tt>&quot;.
It will assume that the local system has all of the file and pillar resources.</p>
<p>Rest of files I will consider separately.</p>
<div class="section" id="user-and-source-code-states">
<h2>User and Source Code states</h2>
<p><tt class="docutils literal">salt/user.sls</tt> creates user &quot;jon_snow&quot;.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">jon_snow</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">user.present</span>
</pre></div>
<p><tt class="docutils literal">salt/source_code.sls</tt> makes shared source code available in jon_snow's home
by creating symlink.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">messaging source code</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">symlink</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/abstract-internal-messaging</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">target</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/abstract-internal-messaging</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">force</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
</pre></div>
<p>Hardcoded path can be replaced by <tt class="docutils literal">{{ <span class="pre">pillar['website_src_dir']</span> }}</tt>,
which will be introduced further.</p>
</div>
<div class="section" id="python-state">
<h2>Python state</h2>
<p><tt class="docutils literal">salt/python.sls</tt> installs Python 2, pip and Virtualenv.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">python2</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">names</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">python-dev</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">python</span>

<span class="l-Scalar-Plain">pip</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">python-pip</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">python2</span>

<span class="l-Scalar-Plain">virtualenv</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pip</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pip</span>
</pre></div>
</div>
<div class="section" id="redis-and-postgresql-states">
<h2>Redis and PostgreSQL states</h2>
<p><tt class="docutils literal">salt/redis.sls</tt> installs Redis.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">redis-server</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkg.installed</span>
</pre></div>
<p><tt class="docutils literal">salt/postgresql/init.sls</tt> installs PostgreSQL 9.1, copies <tt class="docutils literal">pg_hba.conf</tt>,
starts <tt class="docutils literal">postgresql</tt> service, creates user and database based on pillar's
data.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">postgresql</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">names</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">postgresql-9.1</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">python-dev</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">libpq-dev</span>

  <span class="l-Scalar-Plain">service.running</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">watch</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/etc/postgresql/9.1/main/pg_hba.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgresql</span>

  <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/etc/postgresql/9.1/main/pg_hba.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">salt://postgresql/pg_hba.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgres</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">group</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgres</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">644</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgresql</span>

<span class="l-Scalar-Plain">postgresql-database-setup</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">postgres_user</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">present</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;postgresql_user&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;postgresql_password&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">createdb</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgres</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">service</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgresql</span>

  <span class="l-Scalar-Plain">postgres_database</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">present</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;postgresql_db&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">encoding</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">UTF8</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">lc_ctype</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">en_US.UTF8</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">lc_collate</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">en_US.UTF8</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">template</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">template0</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">owner</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;postgresql_user&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgres</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">postgres_user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postgresql-database-setup</span>
</pre></div>
<p><tt class="docutils literal">pillar/postgresql.sls</tt></p>
<div class="highlight"><pre><span class="l-Scalar-Plain">postgresql_user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jon_snow</span>
<span class="l-Scalar-Plain">postgresql_password</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ghost</span>
<span class="l-Scalar-Plain">postgresql_db</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jon_snow</span>
</pre></div>
<p><tt class="docutils literal">salt/postgresql/pg_hba.conf</tt></p>
<div class="highlight"><pre><span class="c1"># This file controls: which hosts are allowed to connect, how clients</span>
<span class="c1"># are authenticated, which PostgreSQL user names they can use, which</span>
<span class="c1"># databases they can access. Records take one of these forms:</span>
<span class="c1">#</span>
<span class="c1"># local DATABASE        USER            METHOD  [OPTIONS]</span>
<span class="l-Scalar-Plain">local   jon_snow        jon_snow        md5</span>

<span class="l-Scalar-Plain"># Database administrative login by Unix domain socket</span>
<span class="l-Scalar-Plain">local   all             postgres                                peer</span>

<span class="l-Scalar-Plain"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span>

<span class="l-Scalar-Plain"># &quot;local&quot; is for Unix domain socket connections only</span>
<span class="l-Scalar-Plain">local   all             all                                     trust</span>
<span class="l-Scalar-Plain"># IPv4 local connections</span><span class="p-Indicator">:</span>
<span class="l-Scalar-Plain">host    all             all             127.0.0.1/32            md5</span>
</pre></div>
</div>
<div class="section" id="website-s-django-state">
<h2>Website's Django state</h2>
<p><tt class="docutils literal">salt/website/django.sls</tt> creates virtual environment and installs
project's dependencies there. It copies django settings, collects static
files and migrate db as well.</p>
<div class="highlight"><pre><span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_venv_dir&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}:</span>
  <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">directory</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jon_snow</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">group</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jon_snow</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">makedirs</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>

  <span class="l-Scalar-Plain">virtualenv</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">managed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">no_site_packages</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">distribute</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">requirements</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_requirements_path&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jon_snow</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">no_chown</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pip</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">virtualenv</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_venv_dir&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>

<span class="l-Scalar-Plain">django settings</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">managed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_settings_path&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">salt://website/local.py.template</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">template</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jinja</span>

<span class="l-Scalar-Plain">django-admin collectstatic</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">module</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">run</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">django.collectstatic</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">bin_env</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_venv_dir&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">settings_module</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">messaging.settings.local</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pythonpath</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_src_dir&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">noinput</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">virtualenv</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_venv_dir&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">django settings</span>

<span class="l-Scalar-Plain">django-admin migrate</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">module</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">run</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">django.syncdb</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">bin_env</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_venv_dir&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">settings_module</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">messaging.settings.local</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pythonpath</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_src_dir&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">migrate</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">virtualenv</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span><span class="p-Indicator">[</span><span class="s">&#39;website_venv_dir&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">django settings</span>
</pre></div>
<p>State above actively uses pillar file <tt class="docutils literal">pillar/website.sls</tt>:</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">website_venv_dir</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/venv</span>
<span class="l-Scalar-Plain">website_venv_activate_path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/venv/bin/activate</span>
<span class="l-Scalar-Plain">website_src_dir</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/abstract-internal-messaging</span>
<span class="l-Scalar-Plain">website_requirements_path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/abstract-internal-messaging/requirements_tests.txt</span>
<span class="l-Scalar-Plain">website_settings_path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/abstract-internal-messaging/messaging/settings/local.py</span>
<span class="l-Scalar-Plain">website_static_dir</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/abstract-internal-messaging/collected_static/</span>

<span class="l-Scalar-Plain">website_gunicorn_bin_path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/venv/bin/gunicorn</span>
<span class="l-Scalar-Plain">website_gunicorn_conf_path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/jon_snow/gunicorn.conf.py</span>
</pre></div>
<p>Here is <tt class="docutils literal">salt/website/local.py.template</tt>:</p>
<div class="highlight"><pre><span class="c"># coding: utf-8</span>
<span class="kn">from</span> <span class="nn">.dev</span> <span class="kn">import</span> <span class="o">*</span>


<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&quot;django.db.backends.postgresql_psycopg2&quot;</span><span class="p">,</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&quot;{{ pillar[&#39;postgresql_db&#39;] }}&quot;</span><span class="p">,</span>
        <span class="s">&#39;USER&#39;</span><span class="p">:</span> <span class="s">&quot;{{ pillar[&#39;postgresql_user&#39;] }}&quot;</span><span class="p">,</span>
        <span class="s">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s">&quot;{{ pillar[&#39;postgresql_password&#39;] }}&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">&#39;some secret key&#39;</span>
</pre></div>
</div>
<div class="section" id="website-s-wsgi-server-state">
<h2>Website's WSGI Server state</h2>
<p><tt class="docutils literal">salt/website/wsgiserver.sls</tt> provides supervisored gunicorn running.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">supervisord conf</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">managed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/etc/supervisor/conf.d/website_gunicorn.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">salt://website/supervisord.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">template</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jinja</span>

<span class="l-Scalar-Plain">gunicorn conf</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">managed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="p-Indicator">{{</span> <span class="nv">pillar</span> <span class="p-Indicator">[</span><span class="s">&#39;website_gunicorn_conf_path&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}}</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">salt://website/gunicorn.conf.py</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jon_snow</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">group</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jon_snow</span>

<span class="l-Scalar-Plain">supervisor</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>

<span class="l-Scalar-Plain">supervisored gunicorn</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">supervisord</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">running</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">website_gunicorn</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">update</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">restart</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">watch</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">supervisord conf</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">gunicorn conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">supervisor</span>
</pre></div>
<p><tt class="docutils literal">salt/website/gunicorn.conf.py</tt></p>
<div class="highlight"><pre><span class="c"># coding: utf-8</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>


<span class="n">bind</span> <span class="o">=</span> <span class="s">&#39;127.0.0.1:5000&#39;</span>
<span class="n">workers</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
<p><tt class="docutils literal">salt/website/supervisord.conf</tt></p>
<div class="highlight"><pre><span class="p-Indicator">[</span><span class="nv">program</span><span class="p-Indicator">:</span><span class="nv">website_gunicorn</span><span class="p-Indicator">]</span>
<span class="l-Scalar-Plain">command = {{ pillar[&#39;website_gunicorn_bin_path&#39;] }} -c {{ pillar[&#39;website_gunicorn_conf_path&#39;] }} messaging.wsgi:application</span>
<span class="l-Scalar-Plain">directory = {{ pillar[&#39;website_src_dir&#39;] }}</span>
<span class="l-Scalar-Plain">user = vagrant</span>
<span class="l-Scalar-Plain">autostart = true</span>
<span class="l-Scalar-Plain">autorestart = true</span>
<span class="l-Scalar-Plain">redirect_stderr = True</span>
<span class="l-Scalar-Plain">stdout_logfile = /var/log/supervisor/website_gunicorn.log</span>
</pre></div>
</div>
<div class="section" id="website-s-web-server-state">
<h2>Website's Web Server state</h2>
<p><tt class="docutils literal">salt/website/webserver.sls</tt> installs latest stable Nginx, copies config
file and runs service.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">nginx</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pkgrepo</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">managed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">deb http://nginx.org/packages/ubuntu/ precise nginx</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">key_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://nginx.org/keys/nginx_signing.key</span>

  <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">installed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkgrepo</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">nginx</span>

  <span class="l-Scalar-Plain">service</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">running</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">watch</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pkg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">nginx</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/etc/nginx/nginx.conf</span>

<span class="l-Scalar-Plain">/etc/nginx/nginx.conf</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">managed</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">salt://website/nginx.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">root</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">group</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">root</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">mode</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">644</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">template</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jinja</span>
</pre></div>
<p>Notable in <tt class="docutils literal">salt/website/nginx.conf</tt> is <tt class="docutils literal">sendfile off</tt>. It fixes
<a class="reference external" href="http://jeremyfelt.com/code/2013/01/08/clear-nginx-cache-in-vagrant/">trouble</a>
when Nginx runs in a virtual machine environment.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">worker_processes 2;</span>


<span class="l-Scalar-Plain">events {</span>
    <span class="l-Scalar-Plain">worker_connections 1024;</span>
<span class="l-Scalar-Plain">}</span>


<span class="l-Scalar-Plain">http {</span>
    <span class="l-Scalar-Plain">include mime.types;</span>
    <span class="l-Scalar-Plain">default_type application/octet-stream;</span>

    <span class="l-Scalar-Plain">sendfile off;</span>

    <span class="l-Scalar-Plain">keepalive_timeout 65;</span>

    <span class="l-Scalar-Plain">server {</span>
        <span class="l-Scalar-Plain">listen 80;</span>
        <span class="l-Scalar-Plain">server_name messaging-part-1;</span>

        <span class="l-Scalar-Plain">location /static/ {</span>
            <span class="l-Scalar-Plain">alias {{ pillar[&#39;website_static_dir&#39;] }};</span>
        <span class="l-Scalar-Plain">}</span>

        <span class="l-Scalar-Plain">location / {</span>
            <span class="l-Scalar-Plain">proxy_pass http://localhost:5000;</span>
            <span class="l-Scalar-Plain">proxy_redirect off;</span>
            <span class="l-Scalar-Plain">proxy_set_header Host $host;</span>
            <span class="l-Scalar-Plain">proxy_set_header X-Real-IP $remote_addr;</span>
            <span class="l-Scalar-Plain">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
        <span class="l-Scalar-Plain">}</span>

        <span class="l-Scalar-Plain"># Redirects server error pages to the static page /50x.html</span>
        <span class="l-Scalar-Plain">error_page 500 502 503 504 /50x.html;</span>
        <span class="l-Scalar-Plain">location = /50x.html {</span>
            <span class="l-Scalar-Plain">root html;</span>
        <span class="l-Scalar-Plain">}</span>
    <span class="l-Scalar-Plain">}</span>
<span class="l-Scalar-Plain">}</span>
</pre></div>
</div>
<div class="section" id="top-states">
<h2>Top states</h2>
<p>There is only one thing to do — to add top files and this tree is over.</p>
<p><tt class="docutils literal">salt/top.sls</tt></p>
<div class="highlight"><pre><span class="l-Scalar-Plain">base</span><span class="p-Indicator">:</span>
  <span class="s">&#39;*&#39;</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source_code</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">python</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">redis</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">postgresql</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">website.django</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">website.wsgiserver</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">website.webserver</span>
</pre></div>
<p><tt class="docutils literal">pillar/top.sls</tt></p>
<div class="highlight"><pre><span class="l-Scalar-Plain">base</span><span class="p-Indicator">:</span>
  <span class="s">&#39;*&#39;</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">postgresql</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">website</span>
</pre></div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>This article was mostly about states examples.
It's time to test configuration.</p>
<div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>abstract-internal-messaging/vagrant
<span class="gp">$</span> vagrant up
</pre></div>
<p>In order to reach website you can add <tt class="docutils literal">1.2.3.4 <span class="pre">messaging-part-1</span></tt> to
<tt class="docutils literal">/etc/hosts</tt>. Now it should work:</p>
<div class="highlight"><pre><span class="gp">$</span> curl -i messaging-part-1
</pre></div>
<p>Tests should be passed as well:</p>
<div class="highlight"><pre><span class="gp">$</span> vagrant ssh
<span class="gp">$</span> <span class="nb">source</span> /home/jon_snow/venv/bin/activate
<span class="gp">(venv)$</span> <span class="nb">cd</span> /home/jon_snow/abstract-internal-messaging
<span class="gp">(venv)$</span> ./manage.py <span class="nb">test</span>
</pre></div>
</div>

<p class="subheader">Category: <a href="http://marselester.com/category/infrastructure.html">Infrastructure</a>

    Tagged: 
    <a href="http://marselester.com/tag/python.html">python </a>
    <a href="http://marselester.com/tag/django.html">django </a>
    <a href="http://marselester.com/tag/vagrant.html">vagrant </a>
    <a href="http://marselester.com/tag/salt.html">salt </a>
    <a href="http://marselester.com/tag/saltstack.html">saltstack </a>
</p>




	<h4>Comments</h4>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'marselester'
        var disqus_identifier = "developing-django-project-with-saltstack.html";
        var disqus_url = "http://marselester.com/developing-django-project-with-saltstack.html";

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</article>
    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="http://marselester.com/archives.html">Archives</a>
            <li><a href="http://marselester.com/tags.html">Tags</a>
        </ul>

		
        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="http://marselester.com/category/infrastructure.html">Infrastructure</a></li>
            <li><a href="http://marselester.com/category/misc.html">Misc</a></li>
            <li><a href="http://marselester.com/category/portfolio.html">Portfolio</a></li>
            <li><a href="http://marselester.com/category/python.html">Python</a></li>
   
        </ul>

		
        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="https://github.com/marselester">GitHub</a></li>
            <li><a href="http://www.linkedin.com/in/marselester">LinkedIn</a></li>
            <li><a href="http://instagram.com/marselester">Instagram</a></li>
            <li><a href="http://twitter.com/marselester">Twitter</a></li>
            <li><a href="http://www.facebook.com/marselester">Facebook</a></li>
            <li><a href="http://mmavletkulov.moikrug.ru/">Мой Круг</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
                <p>marselester's blog by Marsel Mavletkulov</p>
            </div>
            </div>
    </div>
</footer>